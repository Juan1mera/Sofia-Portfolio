---
// ArtistSection.astro
import ProjectCard from "./ProjectCard.astro";
---

<section id="artist" class="portfolio-section">
  <div class="header-container">
    <h2 class="section-title">ARTIST</h2>
  </div>

  <div
    class="folder-system"
    id="artist-folders"
    style="--active-folder-color: #2e2820;"
  >
    <!-- Full width background wrapper for CONTENT -->
    <div class="content-background">
      <div class="content-container">
        <!-- Content: Digital -->
        <div class="folder-sheet active" data-tab="digital">
          <div class="project-grid">
            <ProjectCard
              title="Digital Horizon"
              description="A series of digital landscapes exploring lighting and texture."
              images={[
                "https://images.unsplash.com/photo-1547891654-e66ed7ebb968?q=80&w=2070&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?q=80&w=1974&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1502691876148-a84978e59af8?q=80&w=2070&auto=format&fit=crop",
              ]}
              link="#"
            />
            <ProjectCard
              title="Neon Dreams"
              description="Cyberpunk aesthetic character studies and cityscapes."
              images={[
                "https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?q=80&w=1964&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1555680202-c86f0e12f086?q=80&w=2070&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1535378437-0dd43669d3d3?q=80&w=1974&auto=format&fit=crop",
              ]}
              link="#"
            />
            <ProjectCard
              title="Abstract Flows"
              description="Fluid dynamics simulations turned into digital art."
              images={[
                "https://images.unsplash.com/photo-1633511090164-b43840ea1607?q=80&w=2070&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1541359927273-046b49267996?q=80&w=2070&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1550745165-9bc0b252726f?q=80&w=2070&auto=format&fit=crop",
              ]}
              link="#"
            />
            <ProjectCard
              title="Glitch Portraits"
              description="Explorations in data moshing and digital distortion."
              images={[
                "https://images.unsplash.com/photo-1561214115-f2f134cc4912?q=80&w=2018&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1550751827-4bd374c3f58b?q=80&w=2070&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1515405295579-ba7b4549061c?q=80&w=2070&auto=format&fit=crop",
              ]}
              link="#"
            />
          </div>
        </div>

        <!-- Content: Classical -->
        <div class="folder-sheet" data-tab="classical">
          <div class="project-grid">
            <ProjectCard
              title="Oil on Canvas"
              description="Traditional techniques applied to modern subjects."
              images={[
                "https://images.unsplash.com/photo-1579783902614-a3fb3927b6a5?q=80&w=2045&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1578320339890-50349c25d886?q=80&w=2070&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1577083639236-0f555f0b7790?q=80&w=1999&auto=format&fit=crop",
              ]}
              link="#"
            />
            <ProjectCard
              title="Renaissance Revival"
              description="Studies of light and shadow in the style of the old masters."
              images={[
                "https://images.unsplash.com/photo-1578301978693-85fa9c0320b9?q=80&w=2019&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1580136608079-72029d0de130?q=80&w=2076&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1576769062325-a75cb5634560?q=80&w=1974&auto=format&fit=crop",
              ]}
              link="#"
            />
            <ProjectCard
              title="Still Life"
              description="Contemporary takes on the classic still life composition."
              images={[
                "https://images.unsplash.com/photo-1582201387600-47c38575a034?q=80&w=2071&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1536924940846-227afb31e2a5?q=80&w=2066&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1605721911519-3dfeb3be25e7?q=80&w=2070&auto=format&fit=crop",
              ]}
              link="#"
            />
          </div>
        </div>

        <!-- Content: Sketch -->
        <div class="folder-sheet" data-tab="sketch">
          <div class="project-grid">
            <ProjectCard
              title="Charcoal Portraits"
              description="Raw and expressive charcoal drawings of people."
              images={[
                "https://images.unsplash.com/photo-1513364776144-60967b0f800f?q=80&w=2071&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1615184697985-c9bde1b07da7?q=80&w=1974&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1518640165980-d3e0e2aa6c1e?q=80&w=1974&auto=format&fit=crop",
              ]}
              link="#"
            />
            <ProjectCard
              title="Urban Sketching"
              description="Quick sketches capturing the energy of the city."
              images={[
                "https://images.unsplash.com/photo-1580136608260-4eb11f4b64fe?q=80&w=2076&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1586075010923-2dd45eeed858?q=80&w=2070&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1525609004556-c46c7d6cf023?q=80&w=2109&auto=format&fit=crop",
              ]}
              link="#"
            />
            <ProjectCard
              title="Anatomy Studies"
              description="Detailed graphite drawings focusing on human anatomy."
              images={[
                "https://images.unsplash.com/photo-1629814408092-23f2b6040fc6?q=80&w=1974&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1515405295579-ba7b4549061c?q=80&w=2070&auto=format&fit=crop",
                "https://images.unsplash.com/photo-1614730341194-75c60740a5d3?q=80&w=1974&auto=format&fit=crop",
              ]}
              link="#"
            />
          </div>
        </div>
      </div>
    </div>

    <!-- Tabs at Bottom -->
    <div class="tabs-wrapper bottom-tabs">
      <div class="folder-tabs">
        <!-- Tab 1: Digital -->
        <button
          class="tab-btn active"
          data-target="digital"
          data-color="#2e2820"
          data-index="0"
        >
          <div class="tab-background"></div>
          <span class="tab-text">digital</span>
          <div class="tab-layer" data-layer-index="0"></div>
        </button>

        <!-- Tab 2: Classical -->
        <button
          class="tab-btn"
          data-target="classical"
          data-color="#2a2420"
          data-index="1"
        >
          <div class="tab-background"></div>
          <span class="tab-text">classical</span>
          <div class="tab-layer" data-layer-index="1"></div>
        </button>

        <!-- Tab 3: Sketch -->
        <button
          class="tab-btn"
          data-target="sketch"
          data-color="#253038"
          data-index="2"
        >
          <div class="tab-background"></div>
          <span class="tab-text">sketch</span>
          <div class="tab-layer" data-layer-index="2"></div>
        </button>
      </div>
    </div>
  </div>
</section>

<script>
  const system = document.getElementById("artist-folders");
  if (system) {
    const tabs = system.querySelectorAll(".tab-btn");
    const sheets = system.querySelectorAll(".folder-sheet");

    const tabColors = ["#2e2820", "#2a2420", "#253038"];

    function updateLayers() {
      tabs.forEach((tab, index) => {
        const layer = tab.querySelector(".tab-layer") as HTMLElement | null;
        const isActive = tab.classList.contains("active");

        if (layer) {
          if (isActive) {
            layer.style.display = "none";
          } else {
            layer.style.display = "block";
            layer.style.backgroundColor = tabColors[index];
          }
        }
      });
    }

    updateLayers();

    tabs.forEach((tab, currentIndex) => {
      tab.addEventListener("click", () => {
        tabs.forEach((t) => t.classList.remove("active"));
        tab.classList.add("active");
        sheets.forEach((sheet) => sheet.classList.remove("active"));

        const target = tab.getAttribute("data-target");
        const targetSheet = system.querySelector(
          `.folder-sheet[data-tab="${target}"]`,
        );
        if (targetSheet) targetSheet.classList.add("active");

        const color = tab.getAttribute("data-color");
        if (color) {
          system.style.setProperty("--active-folder-color", color);
        }

        updateLayers();
      });
    });
  }
</script>

<style>
  .portfolio-section {
    padding: 6rem 0;
    background-color: var(--color-bg-primary, #0a0a0a);
    color: var(--color-text-primary, #f5f5f5);
    width: 100%;
    overflow-x: hidden;
  }

  .header-container {
    max-width: 1800px;
    width: 90%;
    margin: 0 auto 3rem auto;
    text-align: center;
  }

  .section-title {
    font-family: "Alfa Slab One", serif;
    font-size: clamp(3rem, 10vw, 8rem);
    font-weight: 400;
    color: var(--color-accent, #e3caab);
    text-transform: uppercase;
    line-height: 0.9;
    margin: 0;
    letter-spacing: -0.02em;
  }

  /* Folder System */
  .folder-system {
    width: 100%;
    display: flex;
    flex-direction: column;
    --active-folder-color: #1e1a15;
    transition: --active-folder-color 0.5s ease;
  }

  /* Full Width Background for Content */
  .content-background {
    width: 100%;
    background-color: var(--active-folder-color);
    transition: background-color 0.5s ease;
    padding: 3rem 0 0 0;
    box-shadow: 0 -1px 0 rgba(227, 202, 171, 0.1);
    min-height: 500px;
    margin-bottom: 0;
  }

  /* Centered Content Container */
  .content-container {
    width: 90%;
    max-width: 1800px;
    margin: 0 auto;
    height: 100%;
  }

  .folder-sheet {
    display: none;
    width: 100%;
    height: 100%;
    animation: fadeIn 0.5s ease;
  }

  .folder-sheet.active {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .project-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 2rem;
    width: 100%;
  }

  /* Tabs Wrapper at Bottom */
  .tabs-wrapper {
    width: 90%;
    max-width: 1800px;
    margin: 0 auto;
    display: flex;
    margin-top: 0;
    position: relative;
    padding-top: 60px;
  }

  .tabs-wrapper::before {
    content: "";
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 100vw;
    height: 60px;
    background-color: var(--active-folder-color);
    transition: background-color 0.5s ease;
    z-index: 25;
  }

  .folder-tabs {
    display: flex;
    width: 65%;
    margin-right: auto;
    position: relative;
  }

  .tab-btn {
    flex: 1;
    padding: 1rem 2.5rem;
    cursor: pointer;
    position: relative;
    text-align: center;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    min-height: 30px;
    transform-origin: bottom center;
    background: transparent;
    border: none;
  }

  .tab-background {
    position: absolute;
    inset: 0;
    clip-path: polygon(0 0, 100% 0, 75% 100%, 0 100%);
    z-index: 0;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .tab-btn::after {
    content: "";
    position: absolute;
    inset: 2px;
    clip-path: polygon(0 0, 100% 0, 75% 100%, 0 100%);
    pointer-events: none;
    z-index: 2;
  }

  /* Tab colors — dark warm tones */
  .tab-btn:nth-child(1) {
    color: var(--color-accent, #e3caab);
  }
  .tab-btn:nth-child(1) .tab-background {
    background-color: #2e2820;
  }

  .tab-btn:nth-child(2) {
    color: var(--color-sand-300, #e8d5bc);
  }
  .tab-btn:nth-child(2) .tab-background {
    background-color: #2a2420;
  }

  .tab-btn:nth-child(3) {
    color: var(--color-steel-100, #c4d3e0);
  }
  .tab-btn:nth-child(3) .tab-background {
    background-color: #253038;
  }

  /* Tab layers */
  .tab-layer {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    width: 300vw;
    bottom: 100%;
    pointer-events: none;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: -1;
  }

  .tab-btn:nth-child(1):not(.active) .tab-layer {
    height: calc(60px + 16px);
  }

  .tab-btn:nth-child(2):not(.active) .tab-layer {
    height: calc(60px + 24px);
  }

  .tab-btn:nth-child(3):not(.active) .tab-layer {
    height: calc(60px + 32px);
  }

  .tab-btn:nth-child(1):hover:not(.active) .tab-layer {
    height: calc(60px + 22px);
  }

  .tab-btn:nth-child(2):hover:not(.active) .tab-layer {
    height: calc(60px + 30px);
  }

  .tab-btn:nth-child(3):hover:not(.active) .tab-layer {
    height: calc(60px + 38px);
  }

  /* Active tab */
  .tab-btn.active {
    z-index: 30;
    transform: translateY(0);
    opacity: 1;
  }

  /* Inactive tabs — staircase */
  .tab-btn:nth-child(1):not(.active) {
    z-index: 20;
    transform: translateY(16px);
  }

  .tab-btn:nth-child(2):not(.active) {
    z-index: 15;
    transform: translateY(24px);
  }

  .tab-btn:nth-child(3):not(.active) {
    z-index: 10;
    transform: translateY(32px);
  }

  .tab-btn:nth-child(1):hover:not(.active) {
    transform: translateY(22px);
  }

  .tab-btn:nth-child(2):hover:not(.active) {
    transform: translateY(30px);
  }

  .tab-btn:nth-child(3):hover:not(.active) {
    transform: translateY(38px);
  }

  .tab-text {
    font-family: "Inter", sans-serif;
    font-size: 1.6rem;
    line-height: 1;
    font-weight: 300;
    font-style: italic;
    position: relative;
    z-index: 2;
    letter-spacing: 0.05em;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @media (max-width: 1024px) {
    .folder-tabs {
      width: 60%;
    }
    .header-container,
    .tabs-wrapper,
    .content-container {
      width: 95%;
    }
  }

  @media (max-width: 768px) {
    .folder-tabs {
      width: 100%;
      flex-direction: row;
    }
    .tab-btn {
      min-height: 80px;
      padding: 0.5rem;
      margin-top: 0;
    }
    .tab-btn.active {
      margin-top: 0;
    }
    .tab-text {
      font-size: 1.2rem;
    }
    .content-background {
      padding: 1.5rem 0;
    }
    .project-grid {
      grid-template-columns: 1fr;
    }

    .tab-btn:nth-child(1):not(.active) {
      transform: translateY(12px);
    }

    .tab-btn:nth-child(2):not(.active) {
      transform: translateY(18px);
    }

    .tab-btn:nth-child(3):not(.active) {
      transform: translateY(24px);
    }
  }
</style>
